<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>TaskFolder.RegisterTaskDefinition(String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String) Method</title><meta name="Title" content="RegisterTaskDefinition(String, TaskDefinition, TaskCreation, String, String, TaskLogonType, String)" /><meta name="Help.Id" content="M:Microsoft.Win32.TaskScheduler.TaskFolder.RegisterTaskDefinition(System.String,Microsoft.Win32.TaskScheduler.TaskDefinition,Microsoft.Win32.TaskScheduler.TaskCreation,System.String,System.String,Microsoft.Win32.TaskScheduler.TaskLogonType,System.String)" /><meta name="Help.ContentType" content="Reference" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="guid" content="M_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition_1" /><meta name="Description" content="Registers (creates) a task in a specified location using a instance to define a task." /><meta name="tocFile" content="../toc/IDOB0TC0AA.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/dahall/TaskScheduler"><img alt="Task Scheduler Managed Class Library" style="height: 48px; width: 48px;" src="../icons/tsnew48.png" /></a></div><div id="DocumentationTitle" class="level-item">Task Scheduler Managed Class Library</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="TopicContent" class="column content is-7"><h1>Task<wbr />Folder<span id="LST7B3FF648_0" data-languageSpecificText="cpp=::|nu=."></span>Register<wbr />Task<wbr />Definition(String, Task<wbr />Definition, Task<wbr />Creation, String, String, Task<wbr />Logon<wbr />Type, String) Method</h1><div class="summary">
            Registers (creates) a task in a specified location using a <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> instance to define a task.
            </div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Definition</h2><div id="IDBSection"><strong>Namespace:</strong> <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br /><strong>Assembly:</strong> Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.11.0<div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="https://github.com/dahall/TaskScheduler/blob/master/TaskService/TaskFolder.cs#L480" target="_blank" rel="noopener noreferrer" class="button is-small is-light" title="View the source code"><span class="icon is-small"><i class="fa fa-file-code"></i></span><span>View Source</span></a><a href="https://github.com/dahall/TaskScheduler/issues/new" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs"><span class="keyword">public</span> <span class="identifier">Task</span> <span class="identifier">RegisterTaskDefinition</span>(
	<span class="identifier">string</span> <span class="parameter">path</span>,
	<span class="identifier">TaskDefinition</span> <span class="parameter">definition</span>,
	<span class="identifier">TaskCreation</span> <span class="parameter">createType</span>,
	<span class="identifier">string</span> <span class="parameter">userId</span>,
	<span class="identifier">string</span> <span class="parameter">password</span> = <span class="keyword">null</span>,
	<span class="identifier">TaskLogonType</span> <span class="parameter">logonType</span> = <span class="identifier">TaskLogonType</span>.S4U,
	<span class="identifier">string</span> <span class="parameter">sddl</span> = <span class="keyword">null</span>
)</code></pre></div></div><h4 class="quickLinkHeader">Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">path</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a></dt><dd>The task name. If this value is NULL, the task will be registered in the root task folder and the task name will be a GUID value that is created by the Task Scheduler service. A task name cannot begin or end with a space character. The '.' character cannot be used to specify the current task folder and the '..' characters cannot be used to specify the parent task folder in the path.</dd><dt class="has-text-weight-normal"><span class="parameter">definition</span>  <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a></dt><dd>The <a href="T_Microsoft_Win32_TaskScheduler_TaskDefinition.htm">TaskDefinition</a> of the registered task.</dd><dt class="has-text-weight-normal"><span class="parameter">createType</span>  <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">TaskCreation</a></dt><dd>A union of <a href="T_Microsoft_Win32_TaskScheduler_TaskCreation.htm">TaskCreation</a> flags.</dd><dt class="has-text-weight-normal"><span class="parameter">userId</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a></dt><dd>The user credentials used to register the task.</dd><dt class="has-text-weight-normal"><span class="parameter">password</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a>  (Optional)</dt><dd>The password for the userId used to register the task.</dd><dt class="has-text-weight-normal"><span class="parameter">logonType</span>  <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">TaskLogonType</a>  (Optional)</dt><dd>A <a href="T_Microsoft_Win32_TaskScheduler_TaskLogonType.htm">TaskLogonType</a> value that defines what logon technique is used to run the registered task.</dd><dt class="has-text-weight-normal"><span class="parameter">sddl</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a>  (Optional)</dt><dd>The security descriptor associated with the registered task. You can specify the access control list (ACL) in the security descriptor for a task in order to allow or deny certain users and groups access to a task.</dd></dl><h4 class="quickLinkHeader">Return Value</h4><a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a><br />
            A <a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task</a> instance that represents the new task. This will return <span class="code">null</span> if <span class="parameter">createType</span> is set to <span class="code">ValidateOnly</span> and there are no validation errors.
            </div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Remarks</h2><div id="IDLCSection">This method is effectively the "Save" method for tasks. It takes a modified <span class="code">TaskDefinition</span> instance and registers it in the folder defined by this <span class="code">TaskFolder</span> instance. Optionally, you can use this method to override the user, password and logon type defined in the definition and supply security against the task.</div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Example</h2><div id="IDMCSection"><p>This first example registers a simple task with a single trigger and action using the default security.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// Create a new task definition for the local machine and assign properties
TaskDefinition td = TaskService.Instance.NewTask();
td.RegistrationInfo.Description = "Does something";

// Add a trigger that, starting tomorrow, will fire every other week on Monday and Saturday
td.Triggers.Add(new WeeklyTrigger(DaysOfTheWeek.Monday | DaysOfTheWeek.Saturday, 2));

// Create an action that will launch Notepad whenever the trigger fires
td.Actions.Add("notepad.exe", "c:\\test.log");

// Register the task in the root folder of the local machine using the current user and the S4U logon type
TaskService.Instance.RootFolder.RegisterTaskDefinition("Test", td);</code></pre></div></div><p>This example registers that same task using the SYSTEM account.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">TaskService.Instance.RootFolder.RegisterTaskDefinition("TaskName", taskDefinition, TaskCreation.CreateOrUpdate, "SYSTEM", null, TaskLogonType.ServiceAccount);</code></pre></div></div><p>This example registers that same task using a specific username and password along with a security definition.</p><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">TaskService.Instance.RootFolder.RegisterTaskDefinition("TaskName", taskDefinition, TaskCreation.CreateOrUpdate, "userDomain\\userName", "userPassword", TaskLogonType.Password, @"O:BAG:DUD:(A;ID;0x1f019f;;;BA)(A;ID;0x1f019f;;;SY)(A;ID;FA;;;BA)(A;;FR;;;BU)");</code></pre></div></div></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Exceptions</h2><div id="IDJCSection"><table class="table is-hoverable"><tr><td><a href="https://learn.microsoft.com/dotnet/api/system.argumentoutofrangeexception" target="_blank" rel="noopener noreferrer">ArgumentOutOfRangeException</a></td><td>
            Task names may not include any characters which are invalid for file names.
            or
            Task names ending with a period followed by three or fewer characters cannot be retrieved due to a bug in the native library.
            </td></tr><tr><td><a href="T_Microsoft_Win32_TaskScheduler_NotV1SupportedException.htm">NotV1SupportedException</a></td><td>This LogonType is not supported on Task Scheduler 1.0.
            or
            Security settings are not available on Task Scheduler 1.0.
            or
            Registration triggers are not available on Task Scheduler 1.0.
            or
            XML validation not available on Task Scheduler 1.0.</td></tr></table></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Reference</h4><div><a href="T_Microsoft_Win32_TaskScheduler_TaskFolder.htm">TaskFolder Class</a></div><div><a href="Overload_Microsoft_Win32_TaskScheduler_TaskFolder_RegisterTaskDefinition.htm">RegisterTaskDefinition Overload</a></div><div><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Definition</a><ul class="menu"><li><a class="quickLink">Parameters</a></li><li><a class="quickLink">Return Value</a></li></ul></li><li><a class="quickLink">Remarks</a></li><li><a class="quickLink">Example</a></li><li><a class="quickLink">Exceptions</a></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div class="column"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank" rel="noopener noreferrer">© 2022 GitHub Community. All rights reserved.</a></p> 
				</div><div class="column"> 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script><script>
		$(".requestExampleLink").each(function ()
		{
			if(this.href.substring(0, 4).toLowerCase() === "http")
				this.href += "?title=";
			else
				this.href += "?subject=Task%20Scheduler%20Managed%20Class%20Library: ";

			this.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
				encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
				"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		});
	</script></body></html>