<!DOCTYPE html ><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" href="../css/bulma.css" /><link rel="stylesheet" href="../css/font-awesome.min.css" /><link rel="stylesheet" href="../css/presentationStyle.css" /><link rel="stylesheet" href="../css/vs.min.css" /><script src="../scripts/jquery-3.5.1.min.js"></script><script src="../scripts/clipboard.min.js"></script><script src="../scripts/highlight.min.js"></script><script src="../scripts/presentationStyle.js"></script><title>Task.RunEx Method</title><meta name="Title" content="RunEx" /><meta name="Help.Id" content="M:Microsoft.Win32.TaskScheduler.Task.RunEx(Microsoft.Win32.TaskScheduler.TaskRunFlags,System.Int32,System.String,System.String[])" /><meta name="Help.ContentType" content="Reference" /><meta name="container" content="Microsoft.Win32.TaskScheduler" /><meta name="guid" content="M_Microsoft_Win32_TaskScheduler_Task_RunEx" /><meta name="Description" content="Runs the registered task immediately using specified flags and a session identifier." /><meta name="tocFile" content="../toc/IDB0AC0AA.xml" /></head><body><div class="fixedLayout"><div id="Header" class="fixedHeader"><div class="pageHeader level mb-0 py-2 px-4"><div id="TitleContainer" class="level-left"><div class="level-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/dahall/TaskScheduler"><img alt="Task Scheduler Managed Class Library" style="height: 48px; width: 48px;" src="../icons/tsnew48.png" /></a></div><div id="DocumentationTitle" class="level-item">Task Scheduler Managed Class Library</div></div><div id="LangFilterSearchContainer" class="level-right"><div class="level-item"><div class="dropdown is-hoverable"><div class="dropdown-trigger"><button class="button" aria-haspopup="true" aria-controls="dropdown-menu"><span id="CurrentLanguage"></span><span class="icon is-small"><i class="fa fa-angle-down" aria-hidden="true"></i></span></button></div><div class="dropdown-menu" role="menu"><div id="LanguageSelections" class="dropdown-content"><a class="dropdown-item languageFilterItem" data-languageId="cs">C#</a></div></div></div></div><div class="level-item"><form id="SearchForm" action="#" onsubmit="TransferToSearchPage(); return false;"><div class="field"><div class="control has-icons-left"><input id="SearchTerms" class="input" type="text" maxlength="200" placeholder="Search" /><span class="icon is-small is-left"><i class="fa fa-search"></i></span><button id="SearchButton" type="submit" class="is-hidden"></button></div></div></form></div></div></div></div><div class="fixedContent"><nav class="breadcrumb my-1 px-2 border-bottom" role="navigation"><ul id="TopicBreadcrumbs" /></nav><div class="columns pl-5 pr-5 fixedContent"><div id="ShowHideTOCColumn" class="column is-hidden-tablet"><a id="ShowHideTOC">Show/Hide TOC</a></div><div id="TOCColumn" class="column is-hidden-mobile"><nav class="toc"><ul id="TableOfContents" class="toc-menu" /></nav></div><div id="TopicContent" class="column content is-7"><h1>Task<span id="LSTB9A3EB02_0" data-languageSpecificText="cpp=::|nu=."></span>Run<wbr />Ex Method</h1><div class="summary">Runs the registered task immediately using specified flags and a session identifier.</div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Definition</h2><div id="IDBSection"><strong>Namespace:</strong> <a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler</a><br /><strong>Assembly:</strong> Microsoft.Win32.TaskScheduler (in Microsoft.Win32.TaskScheduler.dll) Version: 2.11.0<div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><span class="buttons"><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button><a href="https://github.com/dahall/TaskScheduler/blob/master/TaskService/Task.cs#L1424" target="_blank" rel="noopener noreferrer" class="button is-small is-light" title="View the source code"><span class="icon is-small"><i class="fa fa-file-code"></i></span><span>View Source</span></a><a href="https://github.com/dahall/TaskScheduler/issues/new" target="_blank" rel="noopener noreferrer" class="button is-small is-light requestExampleLink" title="Request an example for this topic"><span class="icon is-small"><i class="fa fa-comment-dots"></i></span><span>Request Example</span></a></span></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs"><span class="keyword">public</span> <span class="identifier">RunningTask</span> <span class="identifier">RunEx</span>(
	<span class="identifier">TaskRunFlags</span> <span class="parameter">flags</span>,
	<span class="identifier">int</span> <span class="parameter">sessionID</span>,
	<span class="identifier">string</span> <span class="parameter">user</span>,
	<span class="keyword">params</span> <span class="identifier">string</span>[] <span class="parameter">parameters</span>
)</code></pre></div></div><h4 class="quickLinkHeader">Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">flags</span>  <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">TaskRunFlags</a></dt><dd>Defines how the task is run.</dd><dt class="has-text-weight-normal"><span class="parameter">sessionID</span>  <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_blank" rel="noopener noreferrer">Int32</a></dt><dd><p>The terminal server session in which you want to start the task.</p><p>
             If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is not passed into the <span class="parameter">flags</span> parameter, then the value
             specified in this parameter is ignored.If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is passed into the flags parameter
             and the sessionID value is less than or equal to 0, then an invalid argument error will be returned.
             </p><p>
             If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is passed into the <span class="parameter">flags</span> parameter and the sessionID
             value is a valid session ID greater than 0 and if no value is specified for the user parameter, then the Task Scheduler service
             will try to start the task interactively as the user who is logged on to the specified session.
             </p><p>
             If the <a href="T_Microsoft_Win32_TaskScheduler_TaskRunFlags.htm">UseSessionId</a> value is passed into the <span class="parameter">flags</span> parameter and the sessionID
             value is a valid session ID greater than 0 and if a user is specified in the user parameter, then the Task Scheduler service
             will try to start the task interactively as the user who is specified in the user parameter.
             </p></dd><dt class="has-text-weight-normal"><span class="parameter">user</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a></dt><dd>The user for which the task runs.</dd><dt class="has-text-weight-normal"><span class="parameter">parameters</span>  <span id="LSTB9A3EB02_1" data-languageSpecificText="cpp=array&lt;"></span><a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a><span id="LSTB9A3EB02_2" data-languageSpecificText="cpp=&gt;|vb=()|nu=[]"></span></dt><dd><p>
             The parameters used as values in the task actions. A maximum of 32 parameters can be supplied. To run a task with no parameters,
             call this method without any values (e.g.
             <div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">RunEx(0, 0, "MyUserName")</code></pre></div></div>
             ).
             </p><p>
             The string values that you specify are paired with names and stored as name-value pairs. If you specify a single string value,
             then Arg0 will be the name assigned to the value. The value can be used in the task action where the $(Arg0) variable is used in
             the action properties.
             </p><p>
             If you pass in values such as "0", "100", and "250" as an array of string values, then "0" will replace the $(Arg0) variables,
             "100" will replace the $(Arg1) variables, and "250" will replace the $(Arg2) variables used in the action properties.
             </p><p>
             For more information and a list of action properties that can use $(Arg0), $(Arg1), ..., $(Arg32) variables in their values, see
             <a href="https://docs.microsoft.com/en-us/windows/desktop/taskschd/task-actions#using-variables-in-action-properties">Task Actions</a>.
             </p></dd></dl><h4 class="quickLinkHeader">Return Value</h4><a href="T_Microsoft_Win32_TaskScheduler_RunningTask.htm">RunningTask</a><br />A <a href="T_Microsoft_Win32_TaskScheduler_RunningTask.htm">RunningTask</a> instance that defines the new instance of the task.</div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Remarks</h2><div id="IDGCSection"><p>
             This method will return without error, but the task will not run if the AllowDemandStart property of ITaskSettings is set to
             false for the task.
             </p><p>If RunEx is invoked from a disabled task, it will return <span class="code">null</span> and the task will not be run.</p></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Example</h2><div id="IDICSection"><div class="codeSnippet"><div class="codeHeader"><span class="codeHeaderTitle">C#</span><button class="button is-small is-light copyCode" title="Copy"><span class="icon is-small"><i class="fa fa-copy"></i></span><span>Copy</span></button></div><div class="codePanel hljs"><pre xml:space="preserve"><code class="language-cs">// Run the current task with a parameter as a different user and ignoring any of the conditions.
var runningTask = myTaskInstance.RunEx(TaskRunFlags.IgnoreConstraints, 0, "DOMAIN\\User", "info");
Console.Write(string.Format("Running task's current action is {0}.", runningTask.CurrentAction));</code></pre></div></div></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>Exceptions</h2><div id="IDHCSection"><table class="table is-hoverable"><tr><td><a href="T_Microsoft_Win32_TaskScheduler_NotV1SupportedException.htm">NotV1SupportedException</a></td><td>Not supported under Task Scheduler 1.0.</td></tr></table></div><h2 class="quickLinkHeader"><span class="icon toggleSection" tabindex="0"><i class="fa fa-angle-down"></i></span>See Also</h2><div id="seeAlsoSection"><h4>Reference</h4><div><a href="T_Microsoft_Win32_TaskScheduler_Task.htm">Task Class</a></div><div><a href="N_Microsoft_Win32_TaskScheduler.htm">Microsoft.Win32.TaskScheduler Namespace</a></div></div></div><div id="InThisArticleColumn" class="column is-hidden-mobile"><nav class="menu sticky is-hidden"><p class="menu-label"><strong>In This Article</strong></p><ul id="InThisArticleMenu" class="menu-list"><li><a class="quickLink">Definition</a><ul class="menu"><li><a class="quickLink">Parameters</a></li><li><a class="quickLink">Return Value</a></li></ul></li><li><a class="quickLink">Remarks</a></li><li><a class="quickLink">Example</a></li><li><a class="quickLink">Exceptions</a></li><li><a class="quickLink">See Also</a></li></ul></nav></div></div></div><footer id="PageFooter" class="footer border-top py-3 fixedFooter"><div class="columns"><div class="column"><p><a href="https://github.com/dahall/TaskScheduler/blob/master/license.md" target="_blank" rel="noopener noreferrer">© 2022 GitHub Community. All rights reserved.</a></p> 
				</div><div class="column"> 
				</div></div></footer></div><script>$(function(){
SetDefaultLanguage("cs");
LoadTocFile(null, null);
InitializeQuickLinks();

$(".toggleSection" ).click(function () {
    SectionExpandCollapse(this);
});

$(".toggleSection").keypress(function () {
    SectionExpandCollapseCheckKey(this, event)
});
hljs.highlightAll();
});</script><script>
		$(".requestExampleLink").each(function ()
		{
			if(this.href.substring(0, 4).toLowerCase() === "http")
				this.href += "?title=";
			else
				this.href += "?subject=Task%20Scheduler%20Managed%20Class%20Library: ";

			this.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
				encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
				"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		});
	</script></body></html>